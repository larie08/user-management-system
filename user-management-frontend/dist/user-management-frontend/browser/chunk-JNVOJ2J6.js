import{b as g}from"./chunk-6SARZJB7.js";import{a as f,b as i}from"./chunk-FWEY4UKP.js";import{Ba as p,e as u,j as m,o as s,r}from"./chunk-ORHOKJTR.js";function I(e){return()=>new Promise(a=>{e.refreshToken().subscribe().add(a)})}var D=(()=>{class e{constructor(t){this.accountService=t}intercept(t,n){return n.handle(t).pipe(m(o=>{[401,403].includes(o.status)&&this.accountService.accountValue&&this.accountService.logout();let l=o&&o.error&&o.error.message||o.statusText;return console.error(o),u(l)}))}static{this.\u0275fac=function(n){return new(n||e)(r(i))}}static{this.\u0275prov=s({token:e,factory:e.\u0275fac})}}return e})();var $=(()=>{class e{constructor(t){this.accountService=t}intercept(t,n){let o=this.accountService.accountValue,l=o&&o.jwtToken,w=t.url.startsWith(f.apiUrl);return l&&w&&(t=t.clone({setHeaders:{Authorization:`Bearer ${o.jwtToken}`}})),n.handle(t)}static{this.\u0275fac=function(n){return new(n||e)(r(i))}}static{this.\u0275prov=s({token:e,factory:e.\u0275fac})}}return e})();function q(e,a){return t=>{let n=t.controls[e],o=t.controls[a];o.errors&&!o.errors.mustMatch||(n.value!==o.value?o.setErrors({mustMatch:!0}):o.setErrors(null))}}var C=(()=>{class e{constructor(t,n){this.router=t,this.accountService=n}canActivate(t,n){let o=this.accountService.accountValue;return o?t.data.roles&&!t.data.roles.includes(o.role)?(this.router.navigate(["/"]),!1):!0:(this.router.navigate(["/account/login"],{queryParams:{returnUrl:n.url}}),!1)}static{this.\u0275fac=function(n){return new(n||e)(r(p),r(i))}}static{this.\u0275prov=s({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var y="angular-10-signup-verification-boilerplate-accounts",d=JSON.parse(localStorage.getItem(y))||[];d=d.map(e=>(e.isActive===void 0&&(e.isActive=!0),e.role===g.Admin&&(e.isActive=!0),e.refreshTokens||(e.refreshTokens=[]),e));localStorage.setItem(y,JSON.stringify(d));export{I as a,C as b,D as c,$ as d,q as e};
