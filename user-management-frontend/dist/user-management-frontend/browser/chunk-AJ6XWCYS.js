import{e as U}from"./chunk-JNVOJ2J6.js";import{d as w}from"./chunk-6SARZJB7.js";import{b as _}from"./chunk-FWEY4UKP.js";import{a as Z,b as I,c as f,d as R,e as T,h as P,j as N,k,l as $,m as ee,n as te,q as F,s as ie}from"./chunk-DCNBK2HR.js";import{Aa as re,Ba as b,Ca as y,D as s,E as p,Ea as Y,H as l,J as a,M as r,N as t,O as c,R as W,S as x,T as u,W as o,ea as v,k as J,l as h,oa as E,p as G,qa as S,sa as X,t as g,u as B,x as K,y as Q,za as V}from"./chunk-ORHOKJTR.js";var ne=(()=>{class e{constructor(i,m){this.router=i,this.accountService=m,this.accountService.accountValue&&this.router.navigate(["/"])}static{this.\u0275fac=function(m){return new(m||e)(p(b),p(_))}}static{this.\u0275cmp=g({type:e,selectors:[["ng-component"]],decls:6,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-sm-8","offset-sm-2","mt-5"],[1,"card","m-3"]],template:function(m,n){m&1&&(o(0,"\\"),r(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3),c(5,"router-outlet"),t()()()())},dependencies:[re],encapsulation:2})}}return e})();var oe=e=>({"is-invalid":e});function fe(e,d){e&1&&(r(0,"div"),o(1,"Email is required"),t())}function ue(e,d){e&1&&(r(0,"div"),o(1,"Email is invalid"),t())}function ve(e,d){if(e&1&&(r(0,"div",14),l(1,fe,2,0,"div",15)(2,ue,2,0,"div",15),t()),e&2){let i=u();s(),a("ngIf",i.f.email.errors.required),s(),a("ngIf",i.f.email.errors.email)}}function ge(e,d){e&1&&(r(0,"div"),o(1,"Password is required"),t())}function _e(e,d){if(e&1&&(r(0,"div",14),l(1,ge,2,0,"div",15),t()),e&2){let i=u();s(),a("ngIf",i.f.password.errors.required)}}function he(e,d){e&1&&c(0,"span",16)}var ae=(()=>{class e{constructor(i,m,n,C,L){this.formBuilder=i,this.route=m,this.router=n,this.accountService=C,this.alertService=L,this.loading=!1,this.submitted=!1}ngOnInit(){this.form=this.formBuilder.group({email:["",[f.required,f.email]],password:["",f.required]})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.accountService.login(this.f.email.value,this.f.password.value).pipe(h()).subscribe({next:()=>{let i=this.route.snapshot.queryParams.returnUrl||"/";this.router.navigateByUrl(i)},error:i=>{this.alertService.error(i),this.loading=!1}}))}static{this.\u0275fac=function(m){return new(m||e)(p(F),p(V),p(b),p(_),p(w))}}static{this.\u0275cmp=g({type:e,selectors:[["ng-component"]],decls:25,vars:11,consts:[[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","email",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"form-row"],[1,"col"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","../register",1,"btn","btn-link"],[1,"col","text-right"],["routerLink","../forgot-password",1,"btn","btn-link","pr-0"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(m,n){m&1&&(r(0,"h3",0),o(1,"Login"),t(),r(2,"div",1)(3,"form",2),x("ngSubmit",function(){return n.onSubmit()}),r(4,"div",3)(5,"label"),o(6,"Email"),t(),c(7,"input",4),l(8,ve,3,2,"div",5),t(),r(9,"div",3)(10,"label"),o(11,"Password"),t(),c(12,"input",6),l(13,_e,2,1,"div",5),t(),r(14,"div",3)(15,"div",7)(16,"div",8)(17,"button",9),l(18,he,1,0,"span",10),o(19," Login "),t(),r(20,"a",11),o(21,"Register"),t()(),r(22,"div",12)(23,"a",13),o(24,"Forgot Password?"),t()()()()()()),m&2&&(s(3),a("formGroup",n.form),s(4),a("ngClass",v(7,oe,n.submitted&&n.f.email.errors)),s(),a("ngIf",n.submitted&&n.f.email.errors),s(4),a("ngClass",v(9,oe,n.submitted&&n.f.password.errors)),s(),a("ngIf",n.submitted&&n.f.password.errors),s(4),a("disabled",n.loading),s(),a("ngIf",n.loading))},dependencies:[E,S,P,I,R,T,N,k,y],encapsulation:2})}}return e})();var M=e=>({"is-invalid":e});function Ce(e,d){e&1&&(r(0,"div"),o(1,"Title is required"),t())}function Se(e,d){if(e&1&&(r(0,"div",25),l(1,Ce,2,0,"div",26),t()),e&2){let i=u();s(),a("ngIf",i.f.title.errors.required)}}function be(e,d){e&1&&(r(0,"div"),o(1,"First Name is required"),t())}function ye(e,d){if(e&1&&(r(0,"div",25),l(1,be,2,0,"div",26),t()),e&2){let i=u();s(),a("ngIf",i.f.firstName.errors.required)}}function we(e,d){e&1&&(r(0,"div"),o(1,"Last Name is required"),t())}function xe(e,d){if(e&1&&(r(0,"div",25),l(1,we,2,0,"div",26),t()),e&2){let i=u();s(),a("ngIf",i.f.lastName.errors.required)}}function Ee(e,d){e&1&&(r(0,"div"),o(1,"Email is required"),t())}function Ie(e,d){e&1&&(r(0,"div"),o(1,"Email must be a valid email address"),t())}function Re(e,d){if(e&1&&(r(0,"div",25),l(1,Ee,2,0,"div",26)(2,Ie,2,0,"div",26),t()),e&2){let i=u();s(),a("ngIf",i.f.email.errors.required),s(),a("ngIf",i.f.email.errors.email)}}function Te(e,d){e&1&&(r(0,"div"),o(1,"Password is required"),t())}function Pe(e,d){e&1&&(r(0,"div"),o(1,"Password must be at least 6 characters"),t())}function Ne(e,d){if(e&1&&(r(0,"div",25),l(1,Te,2,0,"div",26)(2,Pe,2,0,"div",26),t()),e&2){let i=u();s(),a("ngIf",i.f.password.errors.required),s(),a("ngIf",i.f.password.errors.minlength)}}function ke(e,d){e&1&&(r(0,"div"),o(1,"Confirm Password is required"),t())}function Fe(e,d){e&1&&(r(0,"div"),o(1,"Passwords must match"),t())}function Ve(e,d){if(e&1&&(r(0,"div",25),l(1,ke,2,0,"div",26)(2,Fe,2,0,"div",26),t()),e&2){let i=u();s(),a("ngIf",i.f.confirmPassword.errors.required),s(),a("ngIf",i.f.confirmPassword.errors.mustMatch)}}function qe(e,d){e&1&&(r(0,"div",25),o(1,"Accept T & C is required"),t())}function Me(e,d){e&1&&c(0,"span",27)}var se=(()=>{class e{constructor(i,m,n,C,L){this.formBuilder=i,this.route=m,this.router=n,this.accountService=C,this.alertService=L,this.loading=!1,this.submitted=!1}ngOnInit(){this.form=this.formBuilder.group({title:["",f.required],firstName:["",f.required],lastName:["",f.required],email:["",[f.required,f.email]],password:["",[f.required,f.minLength(6)]],confirmPassword:["",f.required],acceptTerms:[!1,f.requiredTrue]},{validator:U("password","confirmPassword")})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.accountService.register(this.form.value).pipe(h()).subscribe({next:i=>{i.isFirstAccount?this.alertService.success("Registration successful! You have been automatically verified as the first admin user.",{keepAfterRouteChange:!0}):this.alertService.success("Registration successful, please check your email for verification instructions",{keepAfterRouteChange:!0}),this.router.navigate(["../login"],{relativeTo:this.route})},error:i=>{this.alertService.error(i),this.loading=!1}}))}static{this.\u0275fac=function(m){return new(m||e)(p(F),p(V),p(b),p(_),p(w))}}static{this.\u0275cmp=g({type:e,selectors:[["ng-component"]],decls:57,vars:30,consts:[[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],[1,"form-row"],[1,"form-group","col"],["formControlName","title",1,"form-control",3,"ngClass"],["value",""],["value","Mr"],["value","Mrs"],["value","Miss"],["value","Ms"],["class","invalid-feedback",4,"ngIf"],[1,"form-group","col-5"],["type","text","formControlName","firstName",1,"form-control",3,"ngClass"],["type","text","formControlName","lastName",1,"form-control",3,"ngClass"],["type","text","formControlName","email",1,"form-control",3,"ngClass"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],["type","password","formControlName","confirmPassword",1,"form-control",3,"ngClass"],[1,"form-group","form-check"],["type","checkbox","formControlName","acceptTerms","id","acceptTerms",1,"form-check-input",3,"ngClass"],["for","acceptTerms",1,"form-check-label"],[1,"btn","btn-primary"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","../login",1,"btn","btn-link"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(m,n){m&1&&(r(0,"h3",0),o(1,"Register"),t(),r(2,"div",1)(3,"form",2),x("ngSubmit",function(){return n.onSubmit()}),r(4,"div",3)(5,"div",4)(6,"div",5)(7,"label"),o(8,"Title"),t(),r(9,"select",6),c(10,"option",7),r(11,"option",8),o(12,"Mr"),t(),r(13,"option",9),o(14,"Mrs"),t(),r(15,"option",10),o(16,"Miss"),t(),r(17,"option",11),o(18,"Ms"),t()(),l(19,Se,2,1,"div",12),t(),r(20,"div",13)(21,"label"),o(22,"First Name"),t(),c(23,"input",14),l(24,ye,2,1,"div",12),t(),r(25,"div",13)(26,"label"),o(27,"Last Name"),t(),c(28,"input",15),l(29,xe,2,1,"div",12),t()()(),r(30,"div",3)(31,"label"),o(32,"Email"),t(),c(33,"input",16),l(34,Re,3,2,"div",12),t(),r(35,"div",4)(36,"div",5)(37,"label"),o(38,"Password"),t(),c(39,"input",17),l(40,Ne,3,2,"div",12),t(),r(41,"div",5)(42,"label"),o(43,"Confirm Password"),t(),c(44,"input",18),l(45,Ve,3,2,"div",12),t()(),r(46,"div",19),c(47,"input",20),r(48,"label",21),o(49,"Accept Terms & Conditions"),t(),l(50,qe,2,0,"div",12),t(),r(51,"div",3)(52,"button",22),l(53,Me,1,0,"span",23),o(54," Register "),t(),r(55,"a",24),o(56,"Cancel"),t()()()()),m&2&&(s(3),a("formGroup",n.form),s(6),a("ngClass",v(16,M,n.submitted&&n.f.title.errors)),s(10),a("ngIf",n.submitted&&n.f.title.errors),s(4),a("ngClass",v(18,M,n.submitted&&n.f.firstName.errors)),s(),a("ngIf",n.submitted&&n.f.firstName.errors),s(4),a("ngClass",v(20,M,n.submitted&&n.f.lastName.errors)),s(),a("ngIf",n.submitted&&n.f.lastName.errors),s(4),a("ngClass",v(22,M,n.submitted&&n.f.email.errors)),s(),a("ngIf",n.submitted&&n.f.email.errors),s(5),a("ngClass",v(24,M,n.submitted&&n.f.password.errors)),s(),a("ngIf",n.submitted&&n.f.password.errors),s(4),a("ngClass",v(26,M,n.submitted&&n.f.confirmPassword.errors)),s(),a("ngIf",n.submitted&&n.f.confirmPassword.errors),s(2),a("ngClass",v(28,M,n.submitted&&n.f.acceptTerms.errors)),s(3),a("ngIf",n.submitted&&n.f.acceptTerms.errors),s(3),a("ngIf",n.loading))},dependencies:[E,S,P,ee,te,I,Z,$,R,T,N,k,y],encapsulation:2})}}return e})();function Le(e,d){e&1&&(r(0,"div"),o(1," Verifying... "),t())}function Ae(e,d){e&1&&(r(0,"div"),o(1," Verification failed, you can also verify your account using the "),r(2,"a",3),o(3,"forgot password"),t(),o(4," page. "),t())}var z=function(e){return e[e.Verifying=0]="Verifying",e[e.Failed=1]="Failed",e}(z||{}),me=(()=>{class e{constructor(i,m,n,C){this.route=i,this.router=m,this.accountService=n,this.alertService=C,this.EmailStatus=z,this.emailStatus=z.Verifying}ngOnInit(){let i=this.route.snapshot.queryParams.token;this.router.navigate([],{relativeTo:this.route,replaceUrl:!0}),this.accountService.verifyEmail(i).pipe(h()).subscribe({next:()=>{this.alertService.success("Verification successful, you can now login",{keepAfterRouteChange:!0}),this.router.navigate(["../login"],{relativeTo:this.route})},error:()=>{this.emailStatus=z.Failed}})}static{this.\u0275fac=function(m){return new(m||e)(p(V),p(b),p(_),p(w))}}static{this.\u0275cmp=g({type:e,selectors:[["ng-component"]],decls:5,vars:2,consts:[[1,"card-header"],[1,"card-body"],[4,"ngIf"],["routerLink","forgot-password"]],template:function(m,n){m&1&&(r(0,"h3",0),o(1,"Verify Email"),t(),r(2,"div",1),l(3,Le,2,0,"div",2)(4,Ae,5,0,"div",2),t()),m&2&&(s(3),a("ngIf",n.emailStatus==n.EmailStatus.Verifying),s(),a("ngIf",n.emailStatus==n.EmailStatus.Failed))},dependencies:[S,y],encapsulation:2})}}return e})();var je=e=>({"is-invalid":e});function De(e,d){e&1&&(r(0,"div"),o(1,"Email is required"),t())}function Ge(e,d){e&1&&(r(0,"div"),o(1,"Email is invalid"),t())}function Be(e,d){if(e&1&&(r(0,"div",9),l(1,De,2,0,"div",10)(2,Ge,2,0,"div",10),t()),e&2){let i=u();s(),a("ngIf",i.f.email.errors.required),s(),a("ngIf",i.f.email.errors.email)}}function Ue(e,d){e&1&&c(0,"span",11)}var de=(()=>{class e{constructor(i,m,n){this.formBuilder=i,this.accountService=m,this.alertService=n,this.loading=!1,this.submitted=!1}ngOnInit(){this.form=this.formBuilder.group({email:["",[f.required,f.email]]})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.alertService.clear(),this.accountService.forgotPassword(this.f.email.value).pipe(h()).pipe(J(()=>this.loading=!1)).subscribe({next:()=>this.alertService.success("Please check your email for password reset instructions"),error:i=>this.alertService.error(i)}))}static{this.\u0275fac=function(m){return new(m||e)(p(F),p(_),p(w))}}static{this.\u0275cmp=g({type:e,selectors:[["ng-component"]],decls:15,vars:7,consts:[[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","email",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","../login",1,"btn","btn-link"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(m,n){m&1&&(r(0,"h3",0),o(1,"Forgot Password"),t(),r(2,"div",1)(3,"form",2),x("ngSubmit",function(){return n.onSubmit()}),r(4,"div",3)(5,"label"),o(6,"Email"),t(),c(7,"input",4),l(8,Be,3,2,"div",5),t(),r(9,"div",3)(10,"button",6),l(11,Ue,1,0,"span",7),o(12," Submit "),t(),r(13,"a",8),o(14,"Cancel"),t()()()()),m&2&&(s(3),a("formGroup",n.form),s(4),a("ngClass",v(5,je,n.submitted&&n.f.email.errors)),s(),a("ngIf",n.submitted&&n.f.email.errors),s(2),a("disabled",n.loading),s(),a("ngIf",n.loading))},dependencies:[E,S,P,I,R,T,N,k,y],encapsulation:2})}}return e})();var le=e=>({"is-invalid":e});function Oe(e,d){e&1&&(r(0,"div"),o(1," Validating token... "),t())}function ze(e,d){e&1&&(r(0,"div"),o(1," Token validation failed, if the token has expired you can get a new one at the "),r(2,"a",4),o(3,"forgot password"),t(),o(4," page. "),t())}function Ye(e,d){e&1&&(r(0,"div"),o(1,"Password is required"),t())}function He(e,d){e&1&&(r(0,"div"),o(1,"Password must be at least 6 characters"),t())}function Je(e,d){if(e&1&&(r(0,"div",13),l(1,Ye,2,0,"div",2)(2,He,2,0,"div",2),t()),e&2){let i=u(2);s(),a("ngIf",i.f.password.errors.required),s(),a("ngIf",i.f.password.errors.minlength)}}function Ke(e,d){e&1&&(r(0,"div"),o(1,"Confirm Password is required"),t())}function Qe(e,d){e&1&&(r(0,"div"),o(1,"Passwords must match"),t())}function We(e,d){if(e&1&&(r(0,"div",13),l(1,Ke,2,0,"div",2)(2,Qe,2,0,"div",2),t()),e&2){let i=u(2);s(),a("ngIf",i.f.confirmPassword.errors.required),s(),a("ngIf",i.f.confirmPassword.errors.mustMatch)}}function Xe(e,d){e&1&&c(0,"span",14)}function Ze(e,d){if(e&1){let i=W();r(0,"form",5),x("ngSubmit",function(){K(i);let n=u();return Q(n.onSubmit())}),r(1,"div",6)(2,"label"),o(3,"Password"),t(),c(4,"input",7),l(5,Je,3,2,"div",8),t(),r(6,"div",6)(7,"label"),o(8,"Confirm Password"),t(),c(9,"input",9),l(10,We,3,2,"div",8),t(),r(11,"div",6)(12,"button",10),l(13,Xe,1,0,"span",11),o(14," Reset Password "),t(),r(15,"a",12),o(16,"Cancel"),t()()()}if(e&2){let i=u();a("formGroup",i.form),s(4),a("ngClass",v(7,le,i.submitted&&i.f.password.errors)),s(),a("ngIf",i.submitted&&i.f.password.errors),s(4),a("ngClass",v(9,le,i.submitted&&i.f.confirmPassword.errors)),s(),a("ngIf",i.submitted&&i.f.confirmPassword.errors),s(2),a("disabled",i.loading),s(),a("ngIf",i.loading)}}var D=function(e){return e[e.Validating=0]="Validating",e[e.Valid=1]="Valid",e[e.Invalid=2]="Invalid",e}(D||{}),pe=(()=>{class e{constructor(i,m,n,C,L){this.formBuilder=i,this.route=m,this.router=n,this.accountService=C,this.alertService=L,this.TokenStatus=D,this.tokenStatus=D.Validating,this.token=null,this.loading=!1,this.submitted=!1}ngOnInit(){let i=this.route.snapshot.queryParams.token;if(!i){this.alertService.error("Verification token is missing"),this.router.navigate(["/account/login"]);return}this.form=this.formBuilder.group({password:["",[f.required,f.minLength(6)]],confirmPassword:["",f.required]},{validator:U("password","confirmPassword")}),this.router.navigate([],{relativeTo:this.route,replaceUrl:!0}),this.accountService.validateResetToken(i).pipe(h()).subscribe({next:()=>{this.token=i,this.tokenStatus=D.Valid},error:()=>{this.tokenStatus=D.Invalid}})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.accountService.resetPassword(this.token,this.f.password.value,this.f.confirmPassword.value).pipe(h()).subscribe({next:()=>{this.alertService.success("Password reset successful, you can now login",{keepAfterRouteChange:!0}),this.router.navigate(["../login"],{relativeTo:this.route})},error:i=>{this.alertService.error(i),this.loading=!1}}))}static{this.\u0275fac=function(m){return new(m||e)(p(F),p(V),p(b),p(_),p(w))}}static{this.\u0275cmp=g({type:e,selectors:[["ng-component"]],decls:6,vars:3,consts:[[1,"card-header"],[1,"card-body"],[4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],["routerLink","../forgot-password"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","password","formControlName","confirmPassword",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","../login",1,"btn","btn-link"],[1,"invalid-feedback"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(m,n){m&1&&(r(0,"h3",0),o(1,"Reset Password"),t(),r(2,"div",1),l(3,Oe,2,0,"div",2)(4,ze,5,0,"div",2)(5,Ze,17,11,"form",3),t()),m&2&&(s(3),a("ngIf",n.tokenStatus==n.TokenStatus.Validating),s(),a("ngIf",n.tokenStatus==n.TokenStatus.Invalid),s(),a("ngIf",n.tokenStatus==n.TokenStatus.Valid))},dependencies:[E,S,P,I,R,T,N,k,y],encapsulation:2})}}return e})();var $e=[{path:"",component:ne,children:[{path:"login",component:ae},{path:"register",component:se},{path:"verify-email",component:me},{path:"forgot-password",component:de},{path:"reset-password",component:pe}]}],ce=(()=>{class e{static{this.\u0275fac=function(m){return new(m||e)}}static{this.\u0275mod=B({type:e})}static{this.\u0275inj=G({imports:[Y.forChild($e),Y]})}}return e})();var Gt=(()=>{class e{static{this.\u0275fac=function(m){return new(m||e)}}static{this.\u0275mod=B({type:e})}static{this.\u0275inj=G({imports:[X,ie,ce]})}}return e})();export{Gt as AccountModule};
